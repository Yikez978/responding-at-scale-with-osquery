# Responding @ Scale: Using osquery for Mass Incident Detection & Response

---

# Introduction
## The Natural Place to Start

---

# Kevin Thompson
## Position: PERSON
## Twitter: @blackfist
## Fun Fact: I know more about WWF than all of you...

---

# Heroku

---

# Scott
## Position: DFIR Engineer
## Twitter: @sroberts
## Fun Fact: I know more about StarWars than all of you...

---

# GitHub

---

### Title Explaination
## @Scale is a rip off... But for a good reason...

---

# A Story in Three Parts
## osquery
## osquery use
## osquery use at scale

---

## osquery

---

# What is osquery?

---

# What problems can osquery solve?

---

# how do you use osquery

---

# osqueryi vs osqueryd
## And osqueryctl

---

class: inverse
# osquery use

---

# Query Syntax

---

# Basic Query

---

# Advanced Query

---

# Joins

---

# Real World Query Examples

---
# Query Writing Philosophy

---

# Searching for:
## needles in haystacks (Scott) or looking for interesting  haystacks (Kevin)

---

# Special Capabilities
## Yara

---

# Managing Intelligence with Packs

---

# What Are Packs

---

# Why Packs?
---

# Building Your Own Packs

---

# Using Non-Facebook Packs

---

## ? Performance Impact & Testing ?
- heavy queries and how to avoid them
  - Might need to ask Mike/Teddy
- query profiler
- cgroups

---

class: inverse
# use osquery at scale

---

# How Heroku is Using osquery vs How GitHub is Using osquery

---

# Deploying osquery itself (puppet/chef)

---

# configuration management
  - ad hoc queries
- Introducing Windmill
- logging pipeline
- using those logs
- splunk (1/2 slides)
- elk & elastalert (1/2 slides)

---

class: inverse
## Resources
- osquery.io

---

## Notes/Ideas
- Kingsguard (Formerly GoldCloak) (If I get it done)
- Intel Management/Sharing/Generation

---

# Summary

---

# Thanks
